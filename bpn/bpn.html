<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <title></title>
</head>
<body>

<script type="text/javascript">
    function _rnd_Real( x, y )
    {
        return Math.random() * ( y - x ) + x;
    }
    function _rnd_Int( x, y )
    {
        return Math.floor(
            Math.random() * ( y - x + 1 ) + x
        );
    }
    function _log( l )
    {
        console.log( l );
    }
</script>
<script type="text/javascript">
    var BPN_BIAS = 1.0;
    var BPN_HI = 1.0;
    var BPN_LO = 0.0;

    var BPN_LAYERS = 3;
    var BPN_INP = 2;
    var BPN_HID = 5;
    var BPN_OUT = 1;
    var BPN_MAX = 7;

    var bpnLayers = [ BPN_INP, BPN_HID, BPN_OUT ];

    var bpnOut, bpnErr;
    var bpnWeight;
    var bpnNetError;

    function bpn_Init()
    {
        var l, i, j;
        var w;

        bpnOut = new Array( BPN_LAYERS );
        bpnErr = new Array( BPN_LAYERS );
        for ( l = 0; l < BPN_LAYERS; l++ )
        {
            bpnOut[l] = new Array( BPN_MAX );
            bpnErr[l] = new Array( BPN_MAX );
            for ( i = 0; i < BPN_MAX; i++ )
            {
                bpnOut[l][i] = 0;
                bpnErr[l][i] = 0;
            } // end for i
            bpnOut[l][0] = BPN_BIAS;
            bpnErr[l][0] = BPN_BIAS;
        } // end for l

        bpnWeight = new Array( BPN_LAYERS );
        for ( l = 0; l < BPN_LAYERS; l++ )
        {
            bpnWeight[l] = new Array( BPN_MAX );
            for ( i = 0; i < BPN_MAX; i++ )
            {
                bpnWeight[l][i] = new Array( BPN_MAX );
                for ( j = 0; j < BPN_MAX; j++ )
                {
                    w = _rnd_Real( -0.5, +0.5 );
                    bpnWeight[l][i][j] = w;
                }
            } // end for i

        } // end for l
    }

    function bpn_Propagate()
    {
        var l, i, j;
        var Sum;
        for ( l = 1; l < BPN_LAYERS; l++ )
        {
            for ( i = 1; i <= bpnLayers[l]; i++ )
            {
                Sum = 0;
                for ( j = 0; j <= bpnLayers[l-1]; j++ )
                    Sum += bpnWeight[l][i][j] * bpnOut[l-1][j];
                bpnOut[l][i] = 1.0 / ( 1.0 + Math.exp(-Sum) );
            } // end for i
        } // end for l
    }

    function bpn_ComputeOutputError( Target )
    {
        var i;
        var Out, Err;
        bpnNetError = 0;
        for ( i = 1; i <= BPN_OUT; i++ )
        {
            Out = bpnOut[BPN_LAYERS-1][i];
            Err = Target[i-1] - Out;
            bpnErr[BPN_LAYERS-1][i] = Err * Out * ( 1.0 - Out );
            bpnNetError += (0.5 * ( Err * Err ));
        } // end for i
    }

    function bpn_Backpropagate()
    {
        var l, i, j;
        var Out, Err;
        for ( l = BPN_LAYERS-1; l >= 1; l-- )
        {
            for ( i = 1; i <= bpnLayers[l-1]; i++ )
            {
                Out = bpnErr[l-1][i];
                Err = 0;
                for ( j = 1; j <= bpnLayers[l]; j++ )
                    Err += bpnWeight[l][j][i] * bpnErr[l][j];
                bpnErr[l-1][i] = Err * Out * ( 1.0 - Out );
            } // end for i
        } // end for l
    }

    function bpn_AdjustWeights()
    {
        var l, i, j;
        var Out, Err;
        for ( l = 1; l < BPN_LAYERS; l++ )
        {
            for ( i = 1; i <= bpnLayers[l]; i++ )
            {
                Err = bpnErr[l][i];
                for ( j = 0; j <= bpnLayers[l-1]; j++ )
                {
                    Out = bpnOut[l-1][j];
                    bpnWeight[l][i][j] += 0.5 * Err * Out;
                } // end for j
            } // end for i
        } // end for l
    }

    function bpn_SetInput( Inp )
    {
        var i;
        for ( i = 1; i <= BPN_INP; i++ )
            bpnOut[0][i] = Inp[i-1];
    }

    function bpn_Main()
    {
        var e, n;

        var testInp = [
            [1,0],
            [0,1],
            [1,1],
            [0,0]
        ];
        var testOut = [
            [1],
            [0],
            [0.2],
            [0.7]
        ];

        bpn_Init();

        for ( e = 0; e < 10000; e++ )
        {
            for ( n = 0; n < testInp.length; n++ )
            {
                bpn_SetInput( testInp[n] );
                bpn_Propagate();
                bpn_ComputeOutputError( testOut[n] );
                bpn_Backpropagate();
                bpn_AdjustWeights();
            } // end for n
            if ( e % 10000 == 0 )
                _log( 'bpnNetError='+bpnNetError );
        } // end for e


        for ( n = 0; n < testInp.length; n++ )
        {
            bpn_SetInput( testInp[n] );
            bpn_Propagate();

                _log( bpnOut[BPN_LAYERS-1][1] );

        }
    }
    bpn_Main();
</script>

</body>
</html>