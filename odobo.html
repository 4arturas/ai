<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
</head>
<body>

<script src="p5.min.js"></script>

<!--priority queue-->
<script type="text/javascript">

    function pq_Create( size )
    {
        return { count: 0, arr: new Array(size+1) };
    }

    function pq_Enqueue( pq, e, fnCmp )
    {
        var parent, child;
        pq.count++;
        parent = Math.floor( pq.count/2 );
        child = pq.count;
        while ( parent > 0 )
        {
            if ( fnCmp( pq.arr[parent], e ) )
            {
                pq.arr[child] = pq.arr[parent];
                child = parent;
                parent = Math.floor( parent/2 );
            }
            else
                break;
        } // end while
        pq.arr[child] = e;
    }

    function pq_Dequeue( pq, idx, fnCmp )
    {
        var parent, child;
        var e;
        pq.arr[idx] = pq.arr[pq.count];
        e = pq.arr[idx];
        child = idx*2;
        parent = idx;
        while ( pq.count > child )
        {
            if ( pq.count-1 > child )
                if ( fnCmp( pq.arr[child] , pq.arr[child+1] ) )
                    child++;

            if ( fnCmp( e, pq.arr[child] ) )
            {
                pq.arr[parent] = pq.arr[child];
                parent = child;
                child *= 2;
            }
            else
                break;
        } // end while
        pq.arr[parent] = e;
        pq.count--;
    }

    function pq_CmpTest( e0, e1 )
    {
        return e0.f > e1.f;
    }

    function pq_Test()
    {
        var i;
        var e;
        var n = 10;
        var pq = pq_Create(n);
        for ( i = 0; i < n; i++ )
        {
            e = { f: i };
            pq_Enqueue( pq, e, pq_CmpTest );
        }

        while ( pq.count != 0 )
        {
            e = pq.arr[1];
            console.log(e.f);
            pq_Dequeue( pq, 1, pq_CmpTest );
        }
    }
//    pq_Test();
</script>
<!--end priority queue-->

<!--utils-->
<script type="text/javascript">
    function _log( l )
    {
        console.log( l );
    }
</script>
<!--end utils-->

<!--utils-->
<script type="text/javascript">
    function _log( l )
    {
        console.log( l );
    }

    function _random( x, y )
    {
        return Math.floor(
                Math.random() * ( y - x + 1 ) + x
        );
    }
</script>
<!--end utils-->

<!--vec2D-->
<script type="text/javascript">
    function vec2D_Create( x, y )
    {
        return { x: x, y: y };
    }
</script>
<!--end vec2D-->

<!--utils-->
<script type="text/javascript">

    function odobo_CreateRndCell( _startX )
    {
        var rndX = 30, rndY = 70;
        var x = _random( rndX, rndY );
        var y = _random( rndX, rndY );
        var v0 = vec2D_Create( _startX, y ); // start
        var v1 = vec2D_Create( v0.x, v0.y+y ); // up
        var v2 = vec2D_Create( v1.x+x, v1.y ); // right
        var v3 = vec2D_Create( v2.x, v0.y ); // down
        return [ v0, v1, v2, v3 ];
//        return [ v0, v1, v2 ];
    }

    function odobo_DrawCell( c )
    {
        var i;
        var v0, v1;
        for ( i = 0; i < c.length-1; i++ )
        {
            v0 = c[i];
            v1 = c[i+1];
            line( v0.x, v0.y, v1.x, v1.y );
        }
        v0 = c[i];
        v1 = c[0];
        line( v0.x, v0.y, v1.x, v1.y );
    }

    function odobo_CreateCellArray( _startX, num )
    {
        var cell = new Array( num );
        var i;
        for ( i = 0; i < num; i++ )
        {
            var c = odobo_CreateRndCell( _startX );
            cell[i] = c;
            _startX = c[3].x;
        }
        return cell;
    }

    function odobo_DrawCells( cell )
    {
        var i;
        var c;
        for ( i = 0; i < cell.length; i++ )
            odobo_DrawCell( cell[i] );
    }

    function setup() {
//        createCanvas(640, 480);
        createCanvas(800, 600);
    }

    var p5Done = 0;
    function draw() {
        if ( p5Done != 0 ) return;
        p5Done = 1;

//        line( 0, 0, 100, 100 );

        var cell = odobo_CreateCellArray( 100, 5 );
        odobo_DrawCells( cell );
    }
</script>
<!--end utils-->

</body>
</html>